/* ===== Base Page ===== */
.pest-page {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background: linear-gradient(180deg, #f7faf7 0%, #eef7f1 40%, #ffffff 100%);
  color: #0f172a;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* ===== Layout (4:6 split, side-by-side) ===== */
.pest-container {
  box-sizing: border-box;
  width: 100%;
  max-width: 1280px;
  margin: 0 auto;
  padding: 28px 24px 56px;

  display: grid;
  grid-template-columns: 4fr 6fr;  /* 40% : 60% */
  column-gap: 28px;
  row-gap: 16px;
  align-items: start;
}

/* 히어로(필요 시) 전체폭 */
.pest-hero { grid-column: 1 / -1; margin: 0 0 12px; }
.pest-title { margin: 0 0 6px; font-size: 24px; font-weight: 700; letter-spacing: -0.015em; color: #0b3d2f; }
.pest-subtitle { margin: 0; color: #295a4c; opacity: 0.9; }

/* 왼쪽/오른쪽 배치 */
.left-panel { grid-column: 1 / 2; display: flex; flex-direction: column; gap: 14px; }
.right-panel, .chat-panel { grid-column: 2 / 3; }

/* ===== Upload Card ===== */
.upload-area {
  background: #ffffffcc;
  border: 1px solid #e6eef0;
  border-radius: 16px;
  padding: 18px;
  min-height: 340px;
  display: flex; align-items: center; justify-content: center; text-align: center;
  box-shadow: 0 1px 2px rgba(2, 6, 23, 0.04), 0 6px 20px rgba(2, 6, 23, 0.06);
  transition: border-color .2s ease, box-shadow .2s ease, transform .06s ease;
}
.upload-area:hover { border-color: #cfe6d9; box-shadow: 0 2px 6px rgba(2, 6, 23, 0.05), 0 10px 28px rgba(2, 6, 23, 0.08); transform: translateY(-1px); }
.upload-cta {
  cursor: pointer; background: #f8fbf9; border: 1px dashed #cfe6d9; color: #0f172a;
  border-radius: 12px; padding: 20px 22px; display: inline-flex; flex-direction: column; align-items: center; gap: 10px;
  transition: background .15s ease, border-color .15s ease;
}
.upload-cta:hover { background: #f3faf5; border-color: #a8d7c4; }
.upload-icon { font-size: 28px; }
.upload-hint { font-size: 12px; color: #5b6b7a; }

.preview { width: 100%; max-width: 560px; margin: 0 auto; }
.preview img {
  width: 100%; max-height: 420px; object-fit: contain; background: #fff;
  border: 1px solid #e6eef0; border-radius: 12px; box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06);
}
.preview-name { margin: 12px 0 0; font-size: 13px; color: #475569; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
.preview-actions { margin-top: 12px; }

/* ===== Buttons ===== */
.btn {
  appearance: none;
  border: 1px solid #d7e2e6;
  background: #fff;
  color: #0f172a;
  border-radius: 12px;
  padding: 12px 16px;
  font-weight: 600;
  letter-spacing: -.01em;
  cursor: pointer;
  transition: transform .06s ease, box-shadow .2s ease, border-color .2s ease, background .2s ease, opacity .2s ease;
}
.btn:hover { transform: translateY(-1px); box-shadow: 0 6px 18px rgba(2, 6, 23, 0.06); border-color: #cbd8dd; }
.btn:active { transform: translateY(0); }
.btn:disabled { opacity: 0.6; cursor: not-allowed; }
.btn.primary { background: #10b981; border-color: #10b981; color: #fff; }
.btn.primary:hover { background: #0ea371; border-color: #0ea371; }
.btn.ghost { background: transparent; border-style: dashed; color: #334155; }
.btn.send  { background: #0ea5e9; border-color: #0ea5e9; color: #fff; }

.actions { display: flex; gap: 10px; }

/* ===== Alerts / Loading ===== */
.alert {
  padding: 12px 14px;
  border-radius: 12px;
  border: 1px solid #fee2e2;
  background: #fff5f5;
  color: #9b1c1c;
}

.result.loading .skeleton {
  height: 14px; margin: 8px 0; border-radius: 10px;
  background: linear-gradient(90deg, #e9eef2 0%, #f4f8fb 50%, #e9eef2 100%); background-size: 300% 100%;
  animation: shimmer 1.2s infinite;
}
.result.loading .skeleton.title { height: 22px; }
@keyframes shimmer { 0% {background-position:0 0} 100% {background-position:100% 0} }

/* ===== Result Cards ===== */
.result {
  background: #ffffff;
  border: 1px solid #e6eef0;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 1px 2px rgba(2, 6, 23, 0.04), 0 6px 20px rgba(2, 6, 23, 0.06);
}
.result-title { margin: 0 0 12px; font-size: 17px; font-weight: 700; color: #0f172a; }
.result-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px,1fr)); gap: 12px; }
.card { border: 1px solid #e6eef0; border-radius: 14px; background: #fbfefe; padding: 12px; }
.card h4 { margin: 0 0 6px; font-size: 14px; color: #0f172a; }
.pred-main { margin: 0; font-weight: 700; color: #1f2937; }
.confidence { margin-left: 6px; color: #546472; font-weight: 600; }
.topk { list-style: none; margin: 0; padding: 0; }
.topk li { display: flex; justify-content: space-between; align-items: center; padding: 6px 0; border-bottom: 1px dashed #e6eef0; }
.topk li:last-child { border-bottom: none; }
.topk .label { color: #0f172a; }
.topk .score { color: #334155; font-weight: 600; }
.tips { margin: 0; padding-left: 18px; color: #334155; }

/* ===== Chat Panel ===== */
.chat-panel, .right-panel {
  background: #ffffff;
  border: 1px solid #e6eef0;
  border-radius: 16px;
  padding: 16px;
  box-shadow: 0 1px 2px rgba(2, 6, 23, 0.04), 0 6px 20px rgba(2, 6, 23, 0.06);
  display: flex; flex-direction: column;
  min-height: 600px;
}
.chat-title { margin: 4px 4px 0; font-size: 16px; font-weight: 700; color: #0f172a; }

.chat-scroll {
  flex: 1; overflow: auto; margin-top: 8px; padding: 12px;
  background: #f8fafb; border: 1px solid #edf2f6; border-radius: 12px;
}
/* 스크롤바 */
.chat-scroll::-webkit-scrollbar { height: 10px; width: 10px; }
.chat-scroll::-webkit-scrollbar-thumb { background: #cfe0e6; border-radius: 10px; border: 2px solid transparent; background-clip: padding-box; }
.chat-scroll::-webkit-scrollbar-track { background: transparent; }

.bubble { display: flex; margin: 10px 0; }
.bubble .bubble-inner { white-space: pre-wrap; }
.bubble.assistant, .bubble.user {
  padding: 12px 14px; border-radius: 14px; line-height: 1.55; max-width: 80%;
  box-shadow: 0 2px 10px rgba(2, 6, 23, 0.05); font-size: 14.5px;
}
.bubble.assistant { background: #eefcf6; border: 1px solid #d7efe6; color: #0b3d2f; align-self: flex-start; border-top-left-radius: 6px; }
.bubble.user { background: #e7f2ff; border: 1px solid #cfe3ff; color: #0a3a66; align-self: flex-end; border-top-right-radius: 6px; }

/* 타이핑 표시 */
.bubble.typing .bubble-inner { position: relative; color: #0b3d2f; }
.bubble.typing .bubble-inner::after {
  content: "…";
  display: inline-block;
  animation: blink 1s steps(1, end) infinite;
  margin-left: 4px;
}
@keyframes blink { 50% { opacity: 0; } }

/* Quick Suggestions (있다면) */
.quick-suggest { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 10px; }
.chip {
  border: 1px solid #d7e2e6; background: #ffffff; color: #0f172a;
  border-radius: 999px; padding: 6px 12px; font-size: 13px; cursor: pointer;
  transition: background .15s ease, box-shadow .2s ease, transform .06s ease;
}
.chip:hover { background: #f5faf7; box-shadow: 0 4px 12px rgba(2, 6, 23, 0.06); transform: translateY(-1px); }

/* 입력 행 */
.chat-input-row { display: flex; align-items: stretch; gap: 10px; margin-top: 10px; }
.chat-input-row textarea,
.chat-input {
  flex: 1; border-radius: 12px; border: 1px solid #d7e2e6; padding: 12px 14px;
  min-height: 54px; resize: vertical; outline: none; font-family: inherit;
  transition: border-color .15s ease, box-shadow .15s ease, opacity .2s ease;
}
.chat-input-row textarea:focus, .chat-input:focus { border-color: #10b981; box-shadow: 0 0 0 3px rgba(16, 185, 129, .15); }
.chat-input-row textarea:disabled { opacity: 0.6; cursor: not-allowed; }

/* Responsive */
@media (max-width: 980px) {
  .pest-container { grid-template-columns: 1fr; row-gap: 18px; }
  .chat-panel, .right-panel { min-height: 420px; }
  .preview img { max-height: 320px; }
}
